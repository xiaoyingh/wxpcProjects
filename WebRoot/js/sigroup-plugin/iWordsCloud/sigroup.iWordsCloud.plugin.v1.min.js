var iWordCloud={scale:1};iWordCloud.wordle=function(a,b){this.container=$("#"+a),this.w=b&&b.w?b.w:this.container.width(),this.h=b&&b.h?b.h:this.container.height(),this.data=b&&b.data?b.data:null,this.callback=b&&b.callback?b.callback:null,this.fontMin=b&&b.fontMin?b.fontMin:10,this.fontMax=b&&b.fontMax?b.fontMax:100,this.from=b&&(b.from||0==b.from)?Math.max(-90,Math.min(90,b.from)):-60,this.to=b&&(b.to||0==b.to)?Math.max(-90,Math.min(90,b.to)):60,this.count=b&&b.count?b.count:5,this.scale=b&&b.scale?b.scale:iWordCloud.scale,this.font=b&&b.font?b.font:"Impact",this.spiral=b&&b.spiral?b.spiral:"archimedean",this.timeInterval=b&&b.timeInterval?b.timeInterval:10,this.fontSize=d3.scale.linear().range([this.fontMin,this.fontMax]).domain([this.data[this.data.length-1].value||1,this.data[0].value]),this.rotateScale=d3.scale.linear().domain([0,this.count-1]).range([this.from,this.to]),this.fill=d3.scale.category20b(),this.layout,this.svg,this.background,this.vis,this.text,this.exitGroup,this.exitGroupNode},iWordCloud.wordle.prototype.init=function(){var a=this;return a.layout=d3.layout.cloud().size([a.w,a.h]).timeInterval(a.timeInterval).text(function(a){return a.key}).font(a.font).fontSize(function(b){return a.fontSize(+b.value)}).spiral(a.spiral).rotate(function(){return a.rotateScale(~~(Math.random()*a.count))}).iwc(a).on("word",a.progress).on("end",a.draw),a.svg=d3.select("#"+a.container.get(0).id).append("svg").attr("width",a.w).attr("height",a.h),a.background=a.svg.append("g"),a.vis=a.svg.append("g").attr("transform","translate("+[a.w>>1,a.h>>1]+")"),a.layout.stop().words(a.data).start(),a},iWordCloud.wordle.prototype.progress=function(){},iWordCloud.wordle.prototype.draw=function(a,b,c){console.log("draw"),c.scale=b?Math.min(c.w/Math.abs(b[1].x-c.w/2),c.w/Math.abs(b[0].x-c.w/2),c.h/Math.abs(b[1].y-c.h/2),c.h/Math.abs(b[0].y-c.h/2))/2:1,c.text=c.vis.selectAll("text").data(a,function(a){return a.text.toLowerCase()}),c.text.transition().duration(1e3).attr("transform",function(a){return"translate("+[a.x,a.y]+")rotate("+a.rotate+")"}).style("font-size",function(a){return a.size+"px"}),c.text.enter().append("text").attr("text-anchor","middle").attr("transform",function(a){return"translate("+[a.x,a.y]+")rotate("+a.rotate+")"}).style("font-size",function(a){return a.size+"px"}).style("cursor","pointer").on("click",function(a){c.callback&&c.callback(a)}).style("opacity",1e-6).transition().duration(1e3).style("opacity",1),c.text.style("font-family",function(a){return a.font}).style("fill",function(a){return c.fill(a.text.toLowerCase())}).text(function(a){return a.text}),c.exitGroup=c.background.append("g").attr("transform",c.vis.attr("transform")),c.exitGroupNode=c.exitGroup.node(),c.text.exit().each(function(){c.exitGroupNode.appendChild(this)}),c.exitGroup.transition().duration(1e3).style("opacity",1e-6).remove(),c.vis.transition().delay(1e3).duration(750).attr("transform","translate("+[c.w>>1,c.h>>1]+")scale("+c.scale+")")};